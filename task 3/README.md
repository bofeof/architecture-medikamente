### Оценка Data Encryption at Rest and In Transit

Перед внедрением мер защиты данных важно классифицировать информацию по уровню чувствительности, состояния и регуляторным требованиям.

|Группа данных|Пример компании|Состояние|Уровень риска|Правовая основа и требования регуляторов|Риски при нарушениях безопасности|
|---|---|---|---|---|---|
|Персональные данные|ФИО, телефон, email, паспортные данные|At rest / In transit|Высокий|152-ФЗ, GDPR, HIPAA, требования ФСТЭК, ФСБ, Роскомнадзора|Утечка данных, штрафы, иски, репутационные риски|
|Данные по доступам в системы|Логин, пароль|At rest / In transit|Высокий|Требования ФСТЭК, ФСБ, Роскомнадзора|Утечка данных, искажение информации, репутационные риски|
|Медицинские данные|Диагнозы, история болезни, результаты анализов и исследований|At rest / In transit / In use|Высокий|152-ФЗ, GDPR, HIPAA, требования ФСТЭК, ФСБ, Роскомнадзора|Утечка данных, штрафы, иски, репутационные риски|
|Финансовые данные|Финансовая бухгалтерская отчетность, первичная документация|At rest / In transit / In use|Средний|115-ФЗ (отмывание), 98-ФЗ (коммерческая тайна)|Репутационные риски, отмывание, кражи|
|Прочая информация|Обезличенная информация для аналитики|At rest / In transit / In use|Средний|152-ФЗ, GDPR, HIPAA, внутренние compliance-политики|Деанонимизация данных, утечка, репутационные риски|

---

### **Способы и инструменты защиты данных**

**Шифрование и управление ключами**  
- Использование современных алгоритмов шифрования (AES-256) для защиты данных at rest и in transit.  
- Применение цифровой подписи HMAC для проверки целостности и аутентичности данных при передаче между системами.  
- Централизованное управление ключами с помощью KMS / Keycloak или аналогичных решений, обеспечивающее безопасное хранение, ротацию и аудит ключей.  

**Маскирование и токенизация данных**  
- Применение встроенных механизмов на уровне потоков данных (Apache NiFi) согласно архитектуре ландшафта:  
  - Для аналитики без необходимости восстановления оригинала - хеширование (SHA-256, HMAC).  
  - Для обратимой токенизации - интеграция с HashiCorp Vault или самописным сервисом (БД + API + шифрование через KMS/HSM).  
  - Для защиты файловой системы - full-file encryption, с использованием AES, GPG или внешних KMS/HSM.  
- NiFi может выступать как прокси для шифрования, а ключи управляются централизованно через KMS/HSM.  

**Контроль доступа и авторизация**  
- Организация безопасного доступа через IAM с комбинированной моделью RBAC + ABAC, управляемой через Keycloak.  .  
- Пользователи должны иметь доступ в системы с минимальными привилегиями, необходимыми для работы. ABAC учитывает контекст: местоположение пользователя, время, устройство и другие атрибуты для гибкого контроля доступа.

**Мониторинг и автоматическое реагирование**  
- Интеграция решений для комплексного мониторинга и защиты: SOAR + SIEM + DLP, обеспечивающих обнаружение и автоматическое реагирование на инциденты.  
- Визуализация и аналитика через Grafana и Kibana в реальном времени:  
  - Контроль потоков данных, событий безопасности и метрик системы.  
  - Отслеживание трендов и аномалий для SOC и менеджмента.  
- Пример связки для российского сегмента: MaxPatrol SIEM + MaxPatrol SOAR + SearchInform DLP, где Grafana + Kibana используются для построения дашбордов и визуализации событий.

**Дополнительно**
- Использовать защищенные каналы для передачи данных с использованием протокола TLS 1.3
- Работа с внутрикорпоративной сетью: использовать VPN для безопасного обмена информацией между филиалами


### **Реестр программных и аппаратных средств защиты**

| Категория | Средства | Назначение |
|-----------|----------|------------|
| Шифрование и управление ключами | AES-256, HMAC, GPG | Шифрование данных at rest и in transit, контроль целостности |
| | HashiCorp Vault | Управление ключами, токенизация, интеграция с KMS/HSM |
| | KMS/HSM (аппаратные модули) | Централизованное и защищенное хранение ключей, аппаратное ускорение криптографии |
| | VeraCrypt (альтернативно) | Full-disk/volume encryption (при необходимости на рабочих местах) |
| Маскирование и токенизация | Apache NiFi | Потоковая обработка данных, маскирование и токенизация |
| | Самописный сервис (БД + API + KMS/HSM) | Токенизация и шифрование чувствительных данных |
| Управление доступом и авторизация | Keycloak | IAM, RBAC + ABAC, централизованная авторизация и аутентификация |
| | IAM-политики | Контроль доступа на уровне систем и БД |
| Мониторинг и реагирование (описан рос.сегмент) | MaxPatrol SIEM | Сбор, корреляция и анализ событий безопасности |
| | MaxPatrol SOAR | Автоматизация реагирования на инциденты |
| | SearchInform DLP | Контроль утечек данных и действий пользователей |
| | Grafana, Kibana | Визуализация метрик, событий безопасности и потоков данных |
| Сетевые средства защиты | TLS 1.3 | Защищенная передача данных между системами |
| | VPN | Безопасный обмен информацией между филиалами и удаленными пользователями |

